!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.trees=e()}}(function(){return function e(t,i,r){function n(l,s){if(!i[l]){if(!t[l]){var c="function"==typeof require&&require;if(!s&&c)return c(l,!0);if(o)return o(l,!0);var a=new Error("Cannot find module '"+l+"'");throw a.code="MODULE_NOT_FOUND",a}var d=i[l]={exports:{}};t[l][0].call(d.exports,function(e){var i=t[l][1][e];return n(i?i:e)},d,d.exports,e,t,i,r)}return i[l].exports}for(var o="function"==typeof require&&require,l=0;l<r.length;l++)n(r[l]);return n}({1:[function(e,t,r){(function(r){function n(e,t){function i(e){var t=c.coords.x+" "+c.coords.y+" "+c.getWidth()*c.scale+" "+c.getHeight()*c.scale;c.dom.setAttribute("viewBox",t)}if(void 0===n)var n=r.document;if(void 0===l)var l=r;d.maxIndex=0;var c=this;this.dom=n.getElementById(e),t||(t={}),t.clear?this.clearable=t.clear:this.clearable=!1,t.height?this.dom.setAttribute("height",t.height):(this.height=Number(this.dom.getAttribute("height")),0==this.height&&this.dom.setAttribute("height",200)),this.setPosition(),t.width?this.dom.setAttribute("width",t.width):(this.width=Number(this.dom.getAttribute("width")),0==this.width&&this.dom.setAttribute("width",200)),t.scale?this.scale=t.scale:this.scale=1,this.coords={x:0,y:0},this.prevScale=this.scale,this.setScale(this.scale),this.pinching={status:!1,p1:{x:0,y:0},p2:{x:0,y:0}},this.trees=[],this.dragging={},this.dom.addEventListener("wheel",function(e){e.preventDefault();var t=e.deltaY>0?1:-1;c.setPosition(),c.setScale(c.scale+c.scale*t/10,{ex:e.clientX,ey:e.clientY})}),this.dom.addEventListener("touchstart",function(e){e.preventDefault(),e.target==c.dom&&(2==e.touches.length?(c.pinching.status=!0,c.pinching.p1.x=e.touches[0].clientX,c.pinching.p1.y=e.touches[0].clientY,c.pinching.p2.x=e.touches[1].clientX,c.pinching.p2.y=e.touches[1].clientY):1==e.touches.length&&(e.preventDefault(),c.dragging.dom=!0,c.dragging.currX=e.touches[0].clientX*c.scale,c.dragging.currY=e.touches[0].clientY*c.scale))}),this.dom.addEventListener("touchmove",function(e){if(e.preventDefault(),2==e.touches.length&&c.pinching.status){e.preventDefault();var i=(c.pinching.p1.x-c.pinching.p2.x)*(c.pinching.p1.x-c.pinching.p2.x)+(c.pinching.p1.y-c.pinching.p2.y)*(c.pinching.p1.y-c.pinching.p2.y),r=(e.touches[0].clientX-e.touches[1].clientX)*(e.touches[0].clientX-e.touches[1].clientX)+(e.touches[0].clientY-e.touches[1].clientY)*(e.touches[0].clientY-e.touches[1].clientY);0!=i&&c.setScale(c.prevScale*Math.pow(i/r,.5),{ex:(e.touches[0].clientX+e.touches[1].clientX)/2,ey:(e.touches[0].clientY+e.touches[1].clientY)/2})}else if(1==e.touches.length)if(c.dragging.dom)c.move(e.touches[0].clientX*c.scale-c.dragging.currX,e.touches[0].clientY*c.scale-c.dragging.currY),c.dragging.currX=e.touches[0].clientX*c.scale,c.dragging.currY=e.touches[0].clientY*c.scale;else if(c.dragging.node)for(var n=0;n<c.trees.length;n++)if(c.trees[n]===c.dragging.node._tree)return void s(c,c.dragging.node._tree,c.dragging.node,c.dragging.parent,e.touches[0].clientX,e.touches[0].clientY,{lineType:t.lineType,anchor:c.anchor})}),this.dom.addEventListener("touchend",function(e){e.preventDefault(),c.pinching.status=!1,c.prevScale=c.scale,c.dragging.node=void 0,c.dragging.dom=!1,e.target==c.dom&&(c.deselectedAction&&c.selectedNode&&c.deselectedAction(c.selectedNode),o(c,null))}),this.dom.addEventListener("mousedown",function(e){e.target==c.dom&&(e.preventDefault(),c.dragging.dom=!0,c.dragging.currX=e.clientX*c.scale,c.dragging.currY=e.clientY*c.scale)}),this.dom.addEventListener("mousemove",function(e){if(e.preventDefault(),c.dragging.dom)c.move(e.clientX*c.scale-c.dragging.currX,e.clientY*c.scale-c.dragging.currY),c.dragging.currX=e.clientX*c.scale,c.dragging.currY=e.clientY*c.scale;else if(c.dragging.node)for(var i=0;i<c.trees.length;i++)if(c.trees[i]===c.dragging.node._tree)return void s(c,c.dragging.node._tree,c.dragging.node,c.dragging.parent,e.clientX,e.clientY,{lineType:t.lineType,anchor:c.anchor})}),this.dom.addEventListener("mouseup",function(e){e.preventDefault(),c.dragging.node=void 0,c.dragging.dom=!1}),this.dom.addEventListener("click",function(e){e.target==c.dom&&(c.deselectedAction&&c.selectedNode&&c.deselectedAction(c.selectedNode),o(c,null))}),l.addEventListener("resize",i),this.__proto__.removeEventListeners=function(){l.removeEventListener("resize",i)};var a="0 0 "+this.getWidth()*c.scale+" "+this.getHeight()*c.scale;c.dom.setAttribute("viewBox",a)}function o(e,t,i){e.selectedNode&&(e.selectedNode._rect.style.fill=e.current.fill,e.selectedNode._rect.style.stroke=e.current.stroke),e.selectedNode=t,null!=t&&void 0!=t&&(e.current.fill=t._rect.style.fill,e.current.stroke=t._rect.style.stroke,i||(i={}),i.fill?e.selectedNode._rect.style.fill=i.fill:e.selectedNode._rect.style.fill="#33DD33",i.stroke?e.selectedNode._rect.style.stroke=i.stroke:e.selectedNode._rect.style.stroke="#11BB11")}function l(e,t){if(t._line&&e.removeElement(t._line),t._direction&&e.removeElement(t._direction),t._rect&&e.removeElement(t._rect),t._text&&e.removeElement(t._text),t.parent)for(var i=t.parent.children,r=0;r<i.length;r++)if(i[r]==t)return i.splice(r,1),t;return null}function s(e,t,r,n,o,l,a){a||(a={});var d=r.x,h=r.y;if(r.x=o*e.scale-e.dragging.anchorX,r.y=l*e.scale-e.dragging.anchorY,e.moveRectangle(r._rect,r.x,r.y),e.moveText(r._text,r.x,r.y),c(e,t,r,n),"children"==a.anchor)for(i=0;i<r.children.length;i++)s(e,t,r.children[i],r,(r.children[i].x+r.x-d+e.dragging.anchorX)/e.scale,(r.children[i].y+r.y-h+e.dragging.anchorY)/e.scale,{anchor:"none",lineType:a.lineType});else if("descendents"==a.anchor)for(i=0;i<r.children.length;i++)s(e,t,r.children[i],r,(r.children[i].x+r.x-d+e.dragging.anchorX)/e.scale,(r.children[i].y+r.y-h+e.dragging.anchorY)/e.scale,{anchor:"descendents",lineType:a.lineType})}function c(e,t,i,r,n){if(n||(n={}),i._offset=a(i,r),i._direction&&e.moveCircle(i._direction,i.x+i._offset.x,i.y+i._offset.y),i.children)for(var o=0;o<i.children.length;o++)i.children[o]._direction&&(i.children[o]._offset=a(i.children[o],i),e.moveCircle(i.children[o]._direction,i.children[o].x+i.children[o]._offset.x,i.children[o].y+i.children[o]._offset.y));if("bezier"==t.lineType)for(i._line&&e.resetBezier(i._line,r.x+i._offset.parX,r.y+i._offset.parY,i.x+i._offset.x,i.y+i._offset.y),o=0;o<i.children.length;o++)i.children[o]._line&&("descendents"==n.anchor?e.moveBezier(i.children[o]._line,i.x+i.children[o]._offset.parX,i.y+i.children[o]._offset.parY,i.children[o].x+i.children[o]._offset.x,i.children[o].y+i.children[o]._offset.y):e.resetBezier(i.children[o]._line,i.x+i.children[o]._offset.parX,i.y+i.children[o]._offset.parY,i.children[o].x+i.children[o]._offset.x,i.children[o].y+i.children[o]._offset.y));else for(i._line&&e.moveLine(i._line,r.x+i._offset.parX,r.y+i._offset.parY,i.x+i._offset.x,i.y+i._offset.y),o=0;o<i.children.length;o++)i.children[o]._line&&e.moveLine(i.children[o]._line,i.x+i.children[o]._offset.parX,i.y+i.children[o]._offset.parY,i.children[o].x+i.children[o]._offset.x,i.children[o].y+i.children[o]._offset.y)}function a(e,t,i){if(!t)return{x:0,y:0,parX:0,parY:0};i||(i={});var r={};return"vertical"==i.layout?e.y>t.y+t._rect.height.baseVal.value?(r.parY=t._rect.height.baseVal.value,r.y=0,r.parX=t._rect.width.baseVal.value/2,r.x=e._rect.width.baseVal.value/2):e.y+e._rect.height.baseVal.value<t.y?(r.parY=0,r.y=e._rect.height.baseVal.value,r.parX=t._rect.width.baseVal.value/2,r.x=e._rect.width.baseVal.value/2):e.x>t.x+t._rect.width.baseVal.value?(r.parY=t._rect.height.baseVal.value/2,r.y=e._rect.height.baseVal.value/2,r.parX=t._rect.width.baseVal.value,r.x=0):(r.parY=t._rect.height.baseVal.value/2,r.y=e._rect.height.baseVal.value/2,r.parX=0,r.x=e._rect.width.baseVal.value):e.x>t.x+t._rect.width.baseVal.value?(r.parX=t._rect.width.baseVal.value,r.x=0,r.parY=t._rect.height.baseVal.value/2,r.y=e._rect.height.baseVal.value/2):e.x+e._rect.width.baseVal.value<t.x?(r.parX=0,r.x=e._rect.width.baseVal.value,r.parY=t._rect.height.baseVal.value/2,r.y=e._rect.height.baseVal.value/2):e.y>t.y+t._rect.height.baseVal.value?(r.parX=t._rect.width.baseVal.value/2,r.x=e._rect.width.baseVal.value/2,r.parY=t._rect.height.baseVal.value,r.y=0):(r.parX=t._rect.width.baseVal.value/2,r.x=e._rect.width.baseVal.value/2,r.parY=0,r.y=e._rect.height.baseVal.value),r}var d=e("./Tree");n.prototype.setPosition=function(){var e=this.dom.getBoundingClientRect();this.x=e.left,this.y=e.top},n.prototype.setColor=function(e,t){t||(t={}),e._tree.root===e?(t.fill||(t.fill=e._tree.defaults.rootFill),t.stroke||(t.stroke=e._tree.defaults.rootStroke)):(t.fill||(t.fill=e._tree.defaults.fill),t.stroke||(t.stroke=e._tree.defaults.stroke)),e._rect.style.stroke=t.stroke,e._rect.style.fill=t.fill},n.prototype.setText=function(e,t){e.contents=t,e._text.innerHTML=t;var i=e._text.getBBox();e._rect.setAttribute("width",i.width+2*h),e._rect.setAttribute("height",i.height+2*h),c(this,e._tree,e,e.parent)},n.prototype.setScale=function(e,t){var i=this.getWidth(),r=this.getHeight(),n=this.scale*i,o=this.scale*r;this.scale=e,this.scale<.1?this.scale=.1:this.scale>10?this.scale=10:(t||(t={}),t.ex&&(this.coords.x-=(t.ex-this.x)/i*(i*e-n)),t.ey&&(this.coords.y-=(t.ey-this.y)/r*(r*e-o)),viewBox=this.coords.x+" "+this.coords.y+" "+i*this.scale+" "+r*this.scale,this.dom.setAttribute("viewBox",viewBox))},n.prototype.move=function(e,t){this.coords.x-=e,this.coords.y-=t,viewBox=this.coords.x+" "+this.coords.y+" "+this.getWidth()*this.scale+" "+this.getHeight()*this.scale,this.dom.setAttribute("viewBox",viewBox)},n.prototype.getWidth=function(){if(this.dom.scrollWidth>0)return this.dom.scrollWidth;var e=this.dom.width.baseVal.unitType;return 2==e?this.dom.parentNode.scrollWidth*this.dom.width.baseVal.value:this.dom.width.baseVal.value},n.prototype.getHeight=function(){if(this.dom.scrollHeight>0)return this.dom.scrollHeight;var e=this.dom.height.baseVal.unitType;return 2==e?this.dom.parentNode.scrollHeight*this.dom.height.baseVal.value:this.dom.height.baseVal.value},n.prototype.setAnchor=function(e){this.anchor=e},n.prototype.setSelectedAction=function(e){this.selectedAction=e},n.prototype.setDeselectedAction=function(e){this.deselectedAction=e},n.prototype.addBezier=function(e,t,i,r,n){var o=document.createElementNS("http://www.w3.org/2000/svg","path"),l=(e+i)/2,s=t,c=(e+i)/2,a=r;return o.setAttribute("d","M0 0 C"+(l-e)+" "+(s-t)+" "+(c-e)+" "+(a-t)+" "+(i-e)+" "+(r-t)),o.setAttribute("transform","translate("+e+","+t+")"),o.style.fill="none",n||(n={}),n.stroke?o.style.stroke=n.stroke:o.style.stroke="#000",n.strokeWidth?o.style.strokeWidth=n.strokeWidth:o.style.strokeWidth="2px",this.dom.insertBefore(o,this.dom.firstChild),o},n.prototype.resetBezier=function(e,t,i,r,n){var o=(t+r)/2,l=i,s=(t+r)/2,c=n;e.setAttribute("d","M0 0 C"+(o-t)+" "+(l-i)+" "+(s-t)+" "+(c-i)+" "+(r-t)+" "+(n-i)),e.setAttribute("transform","translate("+t+","+i+")")},n.prototype.moveBezier=function(e,t,i){e.setAttribute("transform","translate("+t+","+i+")")},n.prototype.addCircle=function(e,t,i,r){var n=document.createElementNS("http://www.w3.org/2000/svg","circle");return n.setAttribute("cx",e),n.setAttribute("cy",t),n.setAttribute("r",i),r||(r={}),r.fill?n.style.fill=r.fill:n.style.fill="#FFF",r.stroke?n.style.stroke=r.stroke:n.style.stroke="#000",r.strokeWidth?n.style.strokeWidth=r.strokeWidth:n.style.strokeWidth="2px",this.dom.appendChild(n),n},n.prototype.moveCircle=function(e,t,i){e.setAttribute("cx",t),e.setAttribute("cy",i)},n.prototype.addLine=function(e,t,i,r,n){var o=document.createElementNS("http://www.w3.org/2000/svg","line");return o.setAttribute("x1",e),o.setAttribute("y1",t),o.setAttribute("x2",i),o.setAttribute("y2",r),n.stroke?o.style.stroke=n.stroke:o.style.stroke="#000",n.strokeWidth?o.style.strokeWidth=n.strokeWidth:o.style.strokeWidth="2px",this.dom.appendChild(o),o},n.prototype.moveLine=function(e,t,i,r,n){if(r)e.setAttribute("x1",t),e.setAttribute("y1",i),e.setAttribute("x2",r),n&&e.setAttribute("y2",n);else{var o=t-parseFloat(e.getAttribute("x1")),l=i-parseFloat(e.getAttribute("y1"));e.setAttribute("x1",t),e.setAttribute("y1",i),e.setAttribute("x2",parseFloat(e.getAttribute("x2"))+o),e.setAttribute("y2",parseFloat(e.getAttribute("y2"))+l)}};var h=5;n.prototype.addRectangle=function(e,t,i,r,n,o,l){var s=document.createElementNS("http://www.w3.org/2000/svg","rect");if(n&&s.setAttribute("rx",n),o&&s.setAttribute("ry",o),l||(l={}),l.clickable&&(s.style.cursor="pointer"),l.fill?s.style.fill=l.fill:s.style.fill="#FFF",l.stroke?s.style.stroke=l.stroke:s.style.stroke="#000",l.strokeWidth?s.style.strokeWidth=l.strokeWidth:s.style.strokeWidth="1px",l.opacity&&s.setAttribute("fill-opacity",l.opacity),l.child){var c=l.child.getBBox();s.setAttribute("x",e),s.setAttribute("y",t),s.setAttribute("width",c.width+2*h),s.setAttribute("height",c.height+2*h),l.child.parentNode.insertBefore(s,l.child)}else s.setAttribute("x",e),s.setAttribute("y",t),s.setAttribute("width",i),s.setAttribute("height",r),this.dom.appendChild(s);return s},n.prototype.moveRectangle=function(e,t,i,r){r||(r={}),e.setAttribute("x",t),e.setAttribute("y",i)},n.prototype.addText=function(e,t,i,r){var n=document.createElementNS("http://www.w3.org/2000/svg","text");return n.innerHTML=i,n.setAttribute("alignment-baseline","central"),n.setAttribute("pointer-events","none"),n.setAttribute("x",e+h),r||(r={}),r.fill?n.setAttribute("fill",r.fill):n.setAttribute("fill","#000"),this.dom.appendChild(n),n.setAttribute("y",t+h+this.dom.lastChild.getBBox().height/2),n},n.prototype.moveText=function(e,t,i){e.setAttribute("x",t+h),e.setAttribute("y",i+h+e.getBBox().height/2)},n.prototype.clear=function(){d.maxIndex=0,this.dom.innerHTML=""},n.prototype.removeElement=function(e){this.dom.removeChild(e)},n.prototype.removeNode=function(e,t){if(void 0!==t&&!t){for(var i=[e];i.length>0;){for(var r=i.splice(0,1)[0],n=0;n<r.children.length;n++)i.push(r.children[n]);l(this,r)}return e}if(0==e.children.length)return l(this,e)},n.prototype.drawTree=function(e,t){var i=this;i.selectedNode=null,t||(t={}),i.current={};var r=new d(e);r.defaults={},t.fill?r.defaults.fill=t.fill:r.defaults.fill="#BBDDFF",t.stroke?r.defaults.stroke=t.stroke:r.defaults.stroke="#6688BB",t.rootFill?r.defaults.rootFill=t.rootFill:r.defaults.rootFill="#FF6666",t.rootStroke?r.defaults.rootStroke=t.rootStroke:r.defaults.rootStroke="#DD2222",t.lineStroke?r.defaults.lineStroke=t.lineStroke:r.defaults.lineStroke=r.defaults.stroke,t.lineType||(t.lineType="line"),t.cornerRadius?r.defaults.cornerRadius=t.cornerRadius:r.defaults.cornerRadius=2,i.clearable&&i.clear(),r.lineType=t.lineType,r.traverse(function(e,t,n,o){e._tree=r,e.contents&&(e._text=i.addText(0,0,e.contents));var l;l=o?i.addRectangle(0,0,5,5,r.defaults.cornerRadius,r.defaults.cornerRadius,{clickable:!0,fill:r.defaults.fill,stroke:r.defaults.stroke,child:e._text}):i.addRectangle(0,0,5,5,r.defaults.cornerRadius,r.defaults.cornerRadius,{clickable:!0,fill:r.defaults.rootFill,stroke:r.defaults.rootStroke,child:e._text}),e._rect=l}),r.initialize(),r.traverse(function(e,n,o,l){i.moveText(e._text,e.x,e.y),i.moveRectangle(e._rect,e.x,e.y);var s=a(e,l);e._offset=s,l&&("bezier"==t.lineType?e._line=i.addBezier(l.x+s.parX,l.y+s.parY,e.x+s.x,e.y+s.y,{stroke:r.defaults.lineStroke}):(t.lineType="line",e._line=i.addLine(l.x+s.parX,l.y+s.parY,e.x+s.x,e.y+s.y,{stroke:r.defaults.lineStroke})),e._direction=i.addCircle(e.x+s.x,e.y+s.y,2,{fill:r.defaults.lineStroke,stroke:r.defaults.lineStroke}))}),t.anchor||(t.anchor="none"),i.anchor=t.anchor,r.traverse(function(e,r,n,l){e._rect.addEventListener("mousedown",function(r){r.preventDefault(),i.selectedNode&&i.selectedNode!==e&&i.deselectedAction(i.selectedNode),i.selectedAction&&i.selectedAction(e),o(i,e,{fill:t.selectedFill,stroke:t.selectedStroke}),i.dragging.node=e,i.dragging.parent=l,i.dragging.anchorX=r.clientX*i.scale-e.x,i.dragging.anchorY=r.clientY*i.scale-e.y}),e._rect.addEventListener("touchstart",function(r){r.preventDefault(),1==r.touches.length&&(i.selectedAction&&i.selectedAction(e),o(i,e,{fill:t.selectedFill,stroke:t.selectedStroke}),i.dragging.node=e,i.dragging.parent=l,i.dragging.anchorX=r.touches[0].clientX*i.scale-e.x,i.dragging.anchorY=r.touches[0].clientY*i.scale-e.y)})}),i.trees.push(r)},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Tree":2}],2:[function(e,t,i){"use strict";function r(e){this.root=e}function n(e,t,i,r,o){if(void 0!=e&&void 0!=t&&(void 0==i&&(i=0),void 0==r&&(r=0),t(e,i,r,o),e.children))for(var l=0;l<e.children.length;l++)n(e.children[l],t,i+1,l,e)}function o(e,t,i,r){if(void 0!=e&&void 0!=t){void 0==i&&(i=0),void 0==r&&(r=0);var n=[],o=[];for(n.push(e);n.length>0;){var l=n.splice(0,1)[0];if(r++,l.children)for(var s=0;s<l.children.length;s++){var c=l.children[s];c.parent=l,o.push(c)}t(l,i,r),0===n.length&&(n=o,o=[],i++,r=0)}}}function l(e){void 0===e?this.contents="":this.contents=e,this.children=[]}var s=10;r.prototype.initialize=function(){var e=this.root;r.maxIndex||(r.maxIndex=0);var t=0;null!=e&&(o(e,function(e,i,n){n+1>t&&(t=n+1),e.hasOwnProperty("x")||(e.x=165*i),e.hasOwnProperty("y")||(e.y=(n+r.maxIndex)*(e._rect.height.baseVal.value+s))}),r.maxIndex+=t)},r.prototype.traverse=function(e){n(this.root,e)},r.prototype.traverseBFS=function(e){o(this.root,e)},l.prototype.addChild=function(e){var t=new l(e);return this.children.push(t),t},l.prototype.removeChild=function(e){for(var t=0;t<this.children.length;t++)if(this.children[t]===e)return this.children.pop(e),e;return null},t.exports=r},{}],3:[function(e,t,i){"use strict";var r={SVG:e("./component/SVG")};window.trees=t.exports=r},{"./component/SVG":1}]},{},[3])(3)});