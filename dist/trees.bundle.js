!function e(t,r,n){function g(d,o){if(!r[d]){if(!t[d]){var a="function"==typeof require&&require;if(!o&&a)return a(d,!0);if(i)return i(d,!0);var s=new Error("Cannot find module '"+d+"'");throw s.code="MODULE_NOT_FOUND",s}var f=r[d]={exports:{}};t[d][0].call(f.exports,function(e){var r=t[d][1][e];return g(r?r:e)},f,f.exports,e,t,r,n)}return r[d].exports}for(var i="function"==typeof require&&require,d=0;d<n.length;d++)g(n[d]);return g}({1:[function(e,t,r){function n(e,t){this.dom=document.getElementById(e),t?(t.width?(this.dom.setAttribute("width",t.width+"px"),this.width=t.width):(this.dom.setAttribute("width","200px"),this.width=200),t.height?(this.dom.setAttribute("height",t.height+"px"),this.height=t.height):(this.dom.setAttribute("height","200px"),this.height=200)):(this.width=Number(this.dom.getAttribute("width")),0==this.width&&(this.width=200,this.dom.setAttribute("width",this.width+"px")),this.height=Number(this.dom.getAttribute("height")),0==this.height&&(this.height=200,this.dom.setAttribute("height",this.height+"px")))}function g(e,t){if(void 0==t)return{x:0,y:0,parX:0,parY:0};var r={};return e.x>t.x+i?(r.parX=i,r.x=0,r.parY=d/2,r.y=d/2):e.x+i<t.x?(r.parX=0,r.x=i,r.parY=d/2,r.y=d/2):e.y>t.y+d?(r.parX=i/2,r.x=i/2,r.parY=d,r.y=0):(r.parX=i/2,r.x=i/2,r.parY=0,r.y=d),r}n.prototype.addBezier=function(e,t,r,n,g,i,d,o,a){var s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d","M"+e+" "+t+" C"+r+" "+n+" "+g+" "+i+" "+d+" "+o),s.style.fill="none",a||(a={}),a.stroke?s.style.stroke=a.stroke:s.style.stroke="#000",a.strokeWidth?s.style.strokeWidth=a.strokeWidth:s.style.strokeWidth="2px",this.dom.insertBefore(s,this.dom.firstChild),s},n.prototype.resetBezier=function(e,t,r,n,g,i,d,o,a){e.setAttribute("d","M"+t+" "+r+" C"+n+" "+g+" "+i+" "+d+" "+o+" "+a)},n.prototype.moveBezier=function(e,t,r){var n=e.getAttribute("d"),g=n.indexOf(" "),i=(Number(n.substr(1,g))+t,Number(n.substr(g+1,n.indexOf("C")-g-1))+r,"M"+x+" "+y+n.substr(n.indexOf("C"),n.length-1));e.setAttribute("d",i)},n.prototype.addCircle=function(e,t,r,n){var g=document.createElementNS("http://www.w3.org/2000/svg","circle");return g.setAttribute("cx",e),g.setAttribute("cy",t),g.setAttribute("r",r),n||(n={}),n.fill?rect.style.fill=n.fill:rect.style.fill="#FFF",n.stroke?rect.style.stroke=n.stroke:rect.style.stroke="#000",n.strokeWidth?rect.style.strokeWidth=n.strokeWidth:rect.style.strokeWidth="2px",this.dom.appendChild(g),g},n.prototype.addRectangle=function(e,t,r,n,g,i,d){var o=document.createElementNS("http://www.w3.org/2000/svg","rect");return o.setAttribute("x",e),o.setAttribute("y",t),o.setAttribute("width",r),o.setAttribute("height",n),g&&o.setAttribute("rx",g),i&&o.setAttribute("ry",i),d||(d={}),d.fill?o.style.fill=d.fill:o.style.fill="#FFF",d.stroke?o.style.stroke=d.stroke:o.style.stroke="#000",d.strokeWidth?o.style.strokeWidth=d.strokeWidth:o.style.strokeWidth="2px",this.dom.appendChild(o),o},n.prototype.clear=function(){this.dom.innerHTML=""};var i=80,d=25;n.prototype.drawTree=function(e){var t=this;t.clear(),e.traverse(function(e,r,n,o){var a=g(e,o);if(e.offset=a,o){var s=t.addBezier(o.x+a.parX,o.y+a.parY,(o.x+a.parX+e.x+a.x)/2,o.y+a.parY,(o.x+a.parX+e.x+a.x)/2,e.y+a.y,e.x+a.x,e.y+a.y,{stroke:"#5577BB"});e.bezier=s}var f=t.addRectangle(e.x,e.y,i,d,5,5,{fill:"#BBDDFF",stroke:"#88AADD"});e.rect=f}),t.dragging={},e.traverse(function(e,r,n,g){e.rect.onmousedown=function(r){t.dragging.node=e,t.dragging.parent=g,t.dragging.anchorX=r.clientX-e.x,t.dragging.anchorY=r.clientY-e.y},e.rect.addEventListener("touchstart",function(r){t.dragging.node=e,t.dragging.parent=g,t.dragging.anchorX=r.touches[0].clientX-e.x,t.dragging.anchorY=r.touches[0].clientY-e.y})}),t.dom.onmousedown=function(e){e.target==t.dom&&(t.dragging.dom=!0)},t.dom.addEventListener("touchstart",function(e){e.target==t.dom&&(t.dragging.dom=!0,t.dragging.currX=e.touches[0].clientX,t.dragging.currY=e.touches[0].clientY)}),t.dom.onmousemove=function(r){if(t.dragging.node){t.dragging.node.x=r.clientX-t.dragging.anchorX,t.dragging.node.y=r.clientY-t.dragging.anchorY,t.dragging.node.rect.setAttribute("x",t.dragging.node.x),t.dragging.node.rect.setAttribute("y",t.dragging.node.y);var n=g(t.dragging.node,t.dragging.parent);t.dragging.node.offset=n,t.dragging.node.bezier&&t.resetBezier(t.dragging.node.bezier,t.dragging.parent.x+t.dragging.node.offset.parX,t.dragging.parent.y+t.dragging.node.offset.parY,(t.dragging.parent.x+t.dragging.node.offset.parX+t.dragging.node.x+t.dragging.node.offset.x)/2,t.dragging.parent.y+t.dragging.node.offset.parY,(t.dragging.parent.x+t.dragging.node.offset.parX+t.dragging.node.x+t.dragging.node.offset.x)/2,t.dragging.node.y+t.dragging.node.offset.y,t.dragging.node.x+t.dragging.node.offset.x,t.dragging.node.y+t.dragging.node.offset.y);for(var i=0;i<t.dragging.node.children.length;i++)if(t.dragging.node.children[i].bezier){var n=g(t.dragging.node.children[i],t.dragging.node);t.dragging.node.offset=n,t.resetBezier(t.dragging.node.children[i].bezier,t.dragging.node.x+t.dragging.node.offset.parX,t.dragging.node.y+t.dragging.node.offset.parY,(t.dragging.node.x+t.dragging.node.offset.parX+t.dragging.node.children[i].x+t.dragging.node.offset.x)/2,t.dragging.node.y+t.dragging.node.offset.parY,(t.dragging.node.x+t.dragging.node.offset.parX+t.dragging.node.children[i].x+t.dragging.node.offset.x)/2,t.dragging.node.children[i].y+t.dragging.node.offset.y,t.dragging.node.children[i].x+t.dragging.node.offset.x,t.dragging.node.children[i].y+t.dragging.node.offset.y)}}else t.dragging.dom&&e.traverse(function(e,n,i,d){if(e.x+=r.movementX,e.y+=r.movementY,e.rect.setAttribute("x",e.x),e.rect.setAttribute("y",e.y),e.bezier){var o=g(e,d);e.offset=o,t.resetBezier(e.bezier,d.x+e.offset.parX,d.y+e.offset.parY,(d.x+e.offset.parX+e.x+e.offset.x)/2,d.y+e.offset.parY,(d.x+e.offset.parX+e.x+e.offset.x)/2,e.y+e.offset.y,e.x+e.offset.x,e.y+e.offset.y)}})},t.dom.addEventListener("touchmove",function(r){if(t.dragging.node){t.dragging.node.x=r.touches[0].clientX-t.dragging.anchorX,t.dragging.node.y=r.touches[0].clientY-t.dragging.anchorY,t.dragging.node.rect.setAttribute("x",t.dragging.node.x),t.dragging.node.rect.setAttribute("y",t.dragging.node.y);var n=g(t.dragging.node,t.dragging.parent);t.dragging.node.offset=n,t.dragging.node.bezier&&t.resetBezier(t.dragging.node.bezier,t.dragging.parent.x+t.dragging.node.offset.parX,t.dragging.parent.y+t.dragging.node.offset.parY,(t.dragging.parent.x+t.dragging.node.offset.parX+t.dragging.node.x+t.dragging.node.offset.x)/2,t.dragging.parent.y+t.dragging.node.offset.parY,(t.dragging.parent.x+t.dragging.node.offset.parX+t.dragging.node.x+t.dragging.node.offset.x)/2,t.dragging.node.y+t.dragging.node.offset.y,t.dragging.node.x+t.dragging.node.offset.x,t.dragging.node.y+t.dragging.node.offset.y);for(var i=0;i<t.dragging.node.children.length;i++)if(t.dragging.node.children[i].bezier){var n=g(t.dragging.node.children[i],t.dragging.node);t.dragging.node.offset=n,t.resetBezier(t.dragging.node.children[i].bezier,t.dragging.node.x+t.dragging.node.offset.parX,t.dragging.node.y+t.dragging.node.offset.parY,(t.dragging.node.x+t.dragging.node.offset.parX+t.dragging.node.children[i].x+t.dragging.node.offset.x)/2,t.dragging.node.y+t.dragging.node.offset.parY,(t.dragging.node.x+t.dragging.node.offset.parX+t.dragging.node.children[i].x+t.dragging.node.offset.x)/2,t.dragging.node.children[i].y+t.dragging.node.offset.y,t.dragging.node.children[i].x+t.dragging.node.offset.x,t.dragging.node.children[i].y+t.dragging.node.offset.y)}}else t.dragging.dom&&(e.traverse(function(e,n,i,d){if(console.log(r.touches[0].clientX-t.dragging.currX),e.x+=r.touches[0].clientX-t.dragging.currX,e.y+=r.touches[0].clientY-t.dragging.currY,e.rect.setAttribute("x",e.x),e.rect.setAttribute("y",e.y),e.bezier){var o=g(e,d);e.offset=o,t.resetBezier(e.bezier,d.x+e.offset.parX,d.y+e.offset.parY,(d.x+e.offset.parX+e.x+e.offset.x)/2,d.y+e.offset.parY,(d.x+e.offset.parX+e.x+e.offset.x)/2,e.y+e.offset.y,e.x+e.offset.x,e.y+e.offset.y)}}),t.dragging.currX=r.touches[0].clientX,t.dragging.currY=r.touches[0].clientY)}),t.dom.onmouseup=function(e){t.dragging.node=void 0,t.dragging.dom=!1},t.dom.addEventListener("touchend",function(e){t.dragging.node=void 0,t.dragging.dom=!1})},t.exports=n},{}],2:[function(e,t,r){"use strict";function n(e){this.root=new i(e)}function g(e,t,r,n,i){if(void 0!=e){void 0==r&&(r=0),t(e,r,n,i);for(var d=0;d<e.children.length;d++)g(e.children[d],t,r+1,d,e)}}function i(e){this.contents=e,this.children=[]}n.prototype.initialize=function(){var e=this.root;null!=e&&g(e,function(e,t,r,n){e.hasOwnProperty("x")||(e.x=110*t),e.hasOwnProperty("y")||(0===t?e.y=0:1===n.children.length?e.y=0:e.y=r/(n.children.length-1)*70)})},n.prototype.traverse=function(e,t,r,n){g(this.root,e,t,r,n)},i.prototype.addChild=function(e){this.children.push(new i(e))},i.prototype.removeChild=function(e){for(var t=0;t<this.children.length;t++)if(this.children[t]===e)return this.children.pop(e),e;return null},t.exports=n},{}],3:[function(e,t,r){"use strict";var n=e("./component/SVG"),g=e("./component/Tree");window.onload=function(){for(var e=new n("mySVG",{width:1880,height:960}),t=new g,r=t.root,i=0;2>i;i++){for(var d=0;3>d;d++)r.addChild();r=r.children[0]}t.initialize(),e.drawTree(t)}},{"./component/SVG":1,"./component/Tree":2}]},{},[3]);